COBOL assignment debugging - Stack Overflow
Skip to main content
Stack Overflow
About
Products
For Teams
Stack Overflow for Teams
Where developers & technologists share private knowledge with coworkers
Advertising
Reach devs & technologists worldwide about your product, service or employer brand
Knowledge Solutions
Data licensing offering for businesses to build and improve AI tools and models
Labs
The future of collective knowledge sharing
About the company
Visit the blog
Loading…
current community
Stack Overflow
help
chat
Meta Stack Overflow
your communities
Sign up or log in to customize your list.
more stack exchange communities
company blog
Log in
Sign up
Home
Questions
AI Assist
Labs
Tags
Challenges
Chat
Articles
Users
Jobs
Companies
Collectives
Communities for your favorite technologies.
Explore all Collectives
Teams
Ask questions, find answers and collaborate at work with Stack Overflow for Teams.
Try Teams for free
Explore Teams
Teams
Ask questions, find answers and collaborate at work with Stack Overflow for Teams.
Explore Teams
Collectives™ on Stack Overflow
Find centralized, trusted content and collaborate around the technologies you use most.
Learn more about Collectives
Teams
Q&A for work
Connect and share knowledge within a single location that is structured and easy to search.
Learn more about Teams
COBOL assignment debugging
Ask Question
Asked
yesterday
Modified
yesterday
Viewed
68 times
-4
Here is the prompt for my class assignment:
Create an interactive program for ice cream sales you must sell at least four flavors of ice cream and you must us an evaluate statement. The ice cream needs to be available in a dish or a cone users choice. A cone cost $2 a bowl cost $1.50 Each item needs to be taxed at 5%. The customer must be able to enter multiple items per sale. At the end print a receipt. The receipt must have a header with a date the name of your ice-cream shop and your name. It must have detail showing flavor choice of cone or bowl cost and tax and total. At the end it must have totals for all three columns. The program must be structured.
Here is my code thus far:
IDENTIFICATION DIVISION.
PROGRAM-ID. ICECREAMSALES.
ENVIRONMENT DIVISION.
INPUT-OUTPUT SECTION.
FILE-CONTROL.
SELECT RECEIPT-FILE ASSIGN TO "receipt.txt"
ORGANIZATION IS SEQUENTIAL.
DATA DIVISION.
FILE SECTION.
FD RECEIPT-FILE.
01 RECEIPT-REC PIC X(132).
WORKING-STORAGE SECTION.
77 FLAVOR-CODE
PIC 9.
77 ITEM-TYPE
PIC X.
77 QTY
PIC 99.
77 FLAVOR-NAME
PIC X(15).
77 ITEM-NAME
PIC X(5).
77 ITEM-PRICE
PIC 9V99.
77 SUBTOTAL
PIC 9(5)V99 VALUE 0.
77 TAX
PIC 9(5)V99 VALUE 0.
77 TOTAL
PIC 9(5)V99 VALUE 0.
77 SHOP-NAME
PIC X(25) VALUE "Dan's Icecream".
77 OWNER-NAME
PIC X(25) VALUE "Daniel Goins".
77 SALE-DATE
PIC X(20).
77 MORE-ITEMS
PIC X VALUE 'Y'.
77 VALID-INPUT
PIC X VALUE 'N'.
77 ITEM-LINE-TOTAL
PIC 9(5)V99 VALUE 0.
77 ITEM-LINE-TAX
PIC 9(5)V99 VALUE 0.
77 IDX
PIC 99 VALUE 1.
77 ITEM-COUNT
PIC 99 VALUE 0.
77 EDITED-SUBTOTAL
PIC ZZZZ9.99.
77 EDITED-TAX
PIC ZZZZ9.99.
77 EDITED-TOTAL
PIC ZZZZ9.99.
01 ITEM-LIST.
05 ITEM-FLAVOR-NAME
OCCURS 20 TIMES PIC X(15).
05 ITEM-FLAVOR-TYPE
OCCURS 20 TIMES PIC X(5).
05 ITEM-FLAVOR-PRICE
OCCURS 20 TIMES PIC 9V99.
05 ITEM-FLAVOR-TAX
OCCURS 20 TIMES PIC 9V99.
05 ITEM-FLAVOR-TOTAL
OCCURS 20 TIMES PIC 9V99.
PROCEDURE DIVISION.
MAIN-PROGRAM.
ACCEPT SALE-DATE FROM DATE.
DISPLAY "WELCOME TO " SHOP-NAME
DISPLAY "SALES RECEIPT - " SALE-DATE
DISPLAY "SOLD BY: " OWNER-NAME
DISPLAY "----------------------------------------"
PERFORM UNTIL MORE-ITEMS = 'N' OR MORE-ITEMS = 'n'
DISPLAY "Please choose flavor: "
DISPLAY "1. Vanilla"
DISPLAY "2. Chocolate"
DISPLAY "3. Strawberry"
DISPLAY "4. Mint"
ACCEPT FLAVOR-CODE
EVALUATE FLAVOR-CODE
WHEN 1 MOVE "Vanilla" TO FLAVOR-NAME
WHEN 2 MOVE "Chocolate" TO FLAVOR-NAME
WHEN 3 MOVE "Strawberry" TO FLAVOR-NAME
WHEN 4 MOVE "Mint" TO FLAVOR-NAME
WHEN OTHER
DISPLAY "Invalid flavor! Try again."
NEXT SENTENCE
END-EVALUATE
MOVE 'N' TO VALID-INPUT
PERFORM UNTIL VALID-INPUT = 'Y'
DISPLAY "Dish or Cone? (D/C):"
ACCEPT ITEM-TYPE
IF ITEM-TYPE = 'D' OR ITEM-TYPE = 'd'
MOVE "Dish" TO ITEM-NAME
MOVE 1.50 TO ITEM-PRICE
MOVE 'Y' TO VALID-INPUT
ELSE IF ITEM-TYPE = 'C' OR ITEM-TYPE = 'c'
MOVE "Cone" TO ITEM-NAME
MOVE 2.00 TO ITEM-PRICE
MOVE 'Y' TO VALID-INPUT
ELSE
DISPLAY "Invalid selection! Please enter D/d for Dish or
C/c for Cone."
END-IF
END-PERFORM
DISPLAY "How many do you want?"
ACCEPT QTY
COMPUTE ITEM-LINE-TOTAL = ITEM-PRICE * QTY
COMPUTE ITEM-LINE-TAX = ITEM-LINE-TOTAL * 0.05
ADD 1 TO ITEM-COUNT
MOVE FLAVOR-NAME TO ITEM-FLAVOR-NAME(ITEM-COUNT)
MOVE ITEM-NAME TO ITEM-FLAVOR-TYPE(ITEM-COUNT)
MOVE ITEM-LINE-TOTAL TO ITEM-FLAVOR-PRICE(ITEM-COUNT)
MOVE ITEM-LINE-TAX TO ITEM-FLAVOR-TAX(ITEM-COUNT)
COMPUTE ITEM-FLAVOR-TOTAL(ITEM-COUNT) = ITEM-LINE-TOTAL +
ITEM-LINE-TAX
ADD ITEM-LINE-TOTAL TO SUBTOTAL
ADD ITEM-LINE-TAX TO TAX
MOVE 'N' TO VALID-INPUT
PERFORM UNTIL VALID-INPUT = 'Y'
DISPLAY "Add another item? (Y/N):"
ACCEPT MORE-ITEMS
IF MORE-ITEMS = 'Y' OR MORE-ITEMS = 'y' OR MORE-ITEMS =
'N' OR MORE-ITEMS = 'n'
MOVE 'Y' TO VALID-INPUT
ELSE
DISPLAY "Invalid selection! Please enter Y/y for Yes or
N/n for No."
END-IF
END-PERFORM
END-PERFORM
COMPUTE TOTAL = SUBTOTAL + TAX
MOVE SUBTOTAL TO EDITED-SUBTOTAL
MOVE TAX
TO EDITED-TAX
MOVE TOTAL
TO EDITED-TOTAL
DISPLAY "----------------------------------------"
DISPLAY "Receipt for " SHOP-NAME
DISPLAY "Date: " SALE-DATE
DISPLAY "Sold By: " OWNER-NAME
DISPLAY "----------------------------------------"
DISPLAY "Flavor
Type
Price
Tax
Total"
PERFORM VARYING IDX FROM 1 BY 1 UNTIL IDX > ITEM-COUNT
MOVE ITEM-FLAVOR-NAME(IDX) TO RECEIPT-REC
WRITE RECEIPT-REC
MOVE ITEM-FLAVOR-TYPE(IDX) TO RECEIPT-REC
WRITE RECEIPT-REC
MOVE ITEM-FLAVOR-PRICE(IDX) TO RECEIPT-REC
WRITE RECEIPT-REC
MOVE ITEM-FLAVOR-TAX(IDX) TO RECEIPT-REC
WRITE RECEIPT-REC
MOVE ITEM-FLAVOR-TOTAL(IDX) TO RECEIPT-REC
WRITE RECEIPT-REC
END-PERFORM
DISPLAY "----------------------------------------"
DISPLAY "Totals: "
DISPLAY "Price: " EDITED-SUBTOTAL
DISPLAY " Tax: " EDITED-TAX
DISPLAY " Total: " EDITED-TOTAL
DISPLAY " Thank you for buying at "
DISPLAY SHOP-NAME.
DISPLAY "!"
OPEN OUTPUT RECEIPT-FILE
MOVE "Receipt for " SHOP-NAME TO RECEIPT-REC
WRITE RECEIPT-REC
MOVE "Date: " SALE-DATE TO RECEIPT-REC
WRITE RECEIPT-REC
MOVE "Sold By: " OWNER-NAME TO RECEIPT-REC
WRITE RECEIPT-REC
MOVE "--------------------------------------" TO RECEIPT-REC
WRITE RECEIPT-REC
MOVE "Flavor
Type
Price
Tax
Total" TO RECEIPT-REC
WRITE RECEIPT-REC
PERFORM VARYING IDX FROM 1 BY 1 UNTIL IDX > ITEM-COUNT
MOVE ITEM-FLAVOR-NAME(IDX) TO RECEIPT-REC
WRITE RECEIPT-REC
MOVE ITEM-FLAVOR-TYPE(IDX) TO RECEIPT-REC
WRITE RECEIPT-REC
MOVE ITEM-FLAVOR-PRICE(IDX) TO RECEIPT-REC
WRITE RECEIPT-REC
MOVE ITEM-FLAVOR-TAX(IDX) TO RECEIPT-REC
WRITE RECEIPT-REC
MOVE ITEM-FLAVOR-TOTAL(IDX) TO RECEIPT-REC
WRITE RECEIPT-REC
END-PERFORM
MOVE "--------------------------------------" TO RECEIPT-REC
WRITE RECEIPT-REC
MOVE "Totals:" TO RECEIPT-REC
WRITE RECEIPT-REC
MOVE "Price:" TO RECEIPT-REC
WRITE RECEIPT-REC
MOVE EDITED-SUBTOTAL TO RECEIPT-REC
WRITE RECEIPT-REC
MOVE "Tax:" TO RECEIPT-REC
WRITE RECEIPT-REC
MOVE EDITED-TAX TO RECEIPT-REC
WRITE RECEIPT-REC
MOVE "Total:" TO RECEIPT-REC
WRITE RECEIPT-REC
MOVE EDITED-TOTAL TO RECEIPT-REC
WRITE RECEIPT-REC
MOVE "Thank you for buying at" TO RECEIPT-REC
WRITE RECEIPT-REC
MOVE SHOP-NAME TO RECEIPT-REC
WRITE RECEIPT-REC
CLOSE RECEIPT-FILE
STOP RUN.
I am having compile errors with this section:
PERFORM VARYING IDX FROM 1 BY 1 UNTIL IDX > ITEM-COUNT
MOVE ITEM-FLAVOR-NAME(IDX) TO RECEIPT-REC
WRITE RECEIPT-REC
MOVE ITEM-FLAVOR-TYPE(IDX) TO RECEIPT-REC
WRITE RECEIPT-REC
MOVE ITEM-FLAVOR-PRICE(IDX) TO RECEIPT-REC
WRITE RECEIPT-REC
MOVE ITEM-FLAVOR-TAX(IDX) TO RECEIPT-REC
saying it is an invalid MOVE statement and lastly
DISPLAY "!"
OPEN OUTPUT RECEIPT-FILE
here it says there is a "syntax error, unexpected Identifier, expecting TO"
debuggingvariable-assignmentcobolgnucobol
Share
Improve this question
Follow
edited yesterday
jonrsharpe
123k3030 gold badges274274 silver badges485485 bronze badges
asked yesterday
Katie SmithKatie Smith
1
New contributor
Katie Smith is a new contributor to this site. Take care in asking for clarification, commenting, and answering.
Check out our Code of Conduct.
1
1
Please provide enough code so others can better understand or reproduce the problem.
Community
–
Community
Bot
2025-09-14 20:33:29 +00:00
Commented
yesterday
Add a comment
|
1 Answer
1
Sorted by:
Reset to default
Highest score (default)
Trending (recent votes count more)
Date modified (newest first)
Date created (oldest first)
1
As you've provided the full source we can reproduce this easily:
https://cobol.godbolt.org/z/TeYdhMrn9
and see the right messages from GnuCOBOL and GCC-COBOL at the right places. They point to MOVE statements. a bunch of are invalid because of their type and at least one MOVEs multiple "sources" to one (you may want to use FUNCTION CONCAT or reference-modification or STRING instead).
GCC-COBOL is quite descriptive for the first issue:
error: cannot MOVE 'ITEM-FLAVOR-PRICE' (FldNumericDisplay.2) to 'RECEIPT-REC' (FldAlphanumeric)
You likely want to use a printing-only variable as part of the RECEIPT-REC (or a REDEFINE on it) that uses PIC ZZ9.99.
Share
Improve this answer
Follow
answered yesterday
Simon SobischSimon Sobisch
7,54311 gold badge2121 silver badges4040 bronze badges
Add a comment
|
Your Answer
Thanks for contributing an answer to Stack Overflow!Please be sure to answer the question. Provide details and share your research!But avoid …Asking for help, clarification, or responding to other answers.Making statements based on opinion; back them up with references or personal experience.To learn more, see our tips on writing great answers.
Draft saved
Draft discarded
Sign up or log in
Sign up using Google
Sign up using Email and Password
Submit
Post as a guest
Name
Email
Required, but never shown
Post as a guest
Name
Email
Required, but never shown
Post Your Answer
Discard
By clicking “Post Your Answer”, you agree to our terms of service and acknowledge you have read our privacy policy.
Start asking to get answers
Find the answer to your question by asking.
Ask question
Explore related questions
debuggingvariable-assignmentcobolgnucobol
See similar questions with these tags.
The Overflow Blog
Planning to Arm mobile devices with chips that handle AI
Featured on Meta
Community Asks Sprint Announcement - September 2025
stackoverflow.ai - rebuilt for attribution
Policy: Generative AI (e.g., ChatGPT) is banned
New comment UI experiment graduation
New and improved coding challenges
Related
3860
Why don't Java's +=, -=, *=, /= compound assignment operators require casting?
727
Command not found error in Bash variable assignment
2
COBOL search function
0
run time error in perfoming saving
616
Debugging with command-line parameters in Visual Studio
414
JavaScript OR (||) variable assignment explanation
0
C++ Output Error?
385
Debugging iframes with Chrome developer tools
270
PHP - Debugging Curl
Hot Network Questions
Explanation of Rebbe (R Yehuda HaNasi) making kiddish after his passing
Why is the Bonferroni needed?
How to cut a tetrahedron in half using only a pencil and a knife?
Is it normal for postdoc to write grant proposals for PI, but then is denied the opportunity to work on the projects later on?
A basic graph theory question
Voltage across Vce in a common emitter BJT
Is electrolysis of alumina (Al2O3) without cryolite possible to produce pure Aluminum?
What is the purpose of the neutral line in unbalanced three-phase systems?
What resources are available for identifying a particular Space Shuttle launch?
What is the line of sight distance of a radio transmittion from a high altitude balloon or drone?
Kaleidoscopic supernova
Plugins for exploding map
When do cartographers draw a line for the coast and when do they not?
Where does Bitcoin Core keep the XOR obfuscation keys for both block data files and level DB indexes?
Is there a deeper meaning behind the gesture of the statue here?
Is Exercise 5.3.5 of Chong and Yu's book Recursion Theory really correct?
Statistics on list of industry areas that pure math academics transition to
Get coordinates of a voltage label (circuitikz)
Come vs go in this situation
Hat puzzle with rock, paper, scissors
where and when to put a good olive oil in focaccia?
How to kern letters and put them higher or lower depending on the previous letter?
What is the rationale behind the WebAssembly `if` statements behaving like `block` when it comes to breaking (`br`), rather than being transparent?
Ephemeris Time/Second Tracking
more hot questions
Question feed
Subscribe to RSS
Question feed
To subscribe to this RSS feed, copy and paste this URL into your RSS reader.
Stack Overflow
Questions
Help
Chat
Products
Teams
Advertising
Talent
Company
About
Press
Work Here
Legal
Privacy Policy
Terms of Service
Contact Us
Your Privacy Choices
Cookie Policy
Stack Exchange Network
Technology
Culture & recreation
Life & arts
Science
Professional
Business
API
Data
Blog
Facebook
Twitter
LinkedIn
Instagram
Site design / logo © 2025 Stack Exchange Inc;
user contributions licensed under
CC BY-SA
.
rev 2025.9.15.33996