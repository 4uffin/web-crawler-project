Locky Ransomware Information, Help Guide, and FAQ
News
Featured
Latest
New FileFix attack uses steganography to drop StealC malware
Google confirms fraudulent account created in law enforcement portal
New Phoenix attack bypasses Rowhammer defenses in DDR5 memory
Microsoft to force install the Microsoft 365 Copilot app in October
BreachForums hacking forum admin resentenced to three years in prison
Get 8 courses to kickstart or advance your security career for $30
Microsoft rolls out Copilot Chat to Microsoft 365 Office apps
Google nukes 224 Android malware apps behind massive ad fraud campaign
Tutorials
Latest
Popular
How to access the Dark Web using the Tor Browser
How to enable Kernel-mode Hardware-enforced Stack Protection in Windows 11
How to use the Windows Registry Editor
How to backup and restore the Windows Registry
How to start Windows in Safe Mode
How to remove a Trojan, Virus, Worm, or other Malware
How to show hidden files in Windows 7
How to see hidden files in Windows
Virus Removal Guides
Latest
Most Viewed
Ransomware
Remove the Theonlinesearch.com Search Redirect
Remove the Smartwebfinder.com Search Redirect
How to remove the PBlock+ adware browser extension
Remove the Toksearches.xyz Search Redirect
Remove Security Tool and SecurityTool (Uninstall Guide)
How to Remove WinFixer / Virtumonde / Msevents / Trojan.vundo
How to remove Antivirus 2009 (Uninstall Instructions)
How to remove Google Redirects or the TDSS, TDL3, or Alureon rootkit using TDSSKiller
Locky Ransomware Information, Help Guide, and FAQ
CryptoLocker Ransomware Information Guide and FAQ
CryptorBit and HowDecrypt Information Guide and FAQ
CryptoDefense and How_Decrypt Ransomware Information Guide and FAQ
Downloads
Latest
Most Downloaded
Qualys BrowserCheck
STOPDecrypter
AuroraDecrypter
FilesLockerDecrypter
AdwCleaner
ComboFix
RKill
Junkware Removal Tool
Deals
Categories
eLearning
IT Certification Courses
Gear + Gadgets
Security
VPNs
Popular
Best VPNs
How to change IP address
Access the dark web safely
Best VPN for YouTube
Forums
More
Startup Database
Uninstall Database
Glossary
Chat on Discord
Send us a Tip!
Welcome Guide
HomeVirus, Spyware, Malware, & PUP Removal GuidesLocky Ransomware Information, Help Guide, and FAQ
Locky Ransomware Information, Help Guide, and FAQ
Filed Under :
Ransomware
May 9, 2016
Table of Contents
1What is the Locky Ransomware
2How the Locky Ransomware encrypts your files
3What should you do when you discover your computer is infected with Locky?
4How do you become infected with Locky?
5What you need to know about Locky and Network Shares
6How to find the infected user that encrypted a Network Share
7The Locky Decryptor Page Payment Site
8Will paying the ransom actually decrypt your files?
9Is it possible to decrypt files encrypted by Locky for free?
10How to restore files encrypted by Locky
11How to restore files encrypted by Locky using Shadow Volume Copies
12How to restore files that have been encrypted on DropBox folders
13How to prevent your computer from becoming infected by Locky
14How to allow specific applications to run when using Software Restriction Policies
Info: There is an active Locky support topic that contains discussion and the experiences of a variety of IT consultants, end users, and companies who have been affected by this ransomware program. If you are interested in this infection or wish to ask questions about Locky, please visit
the Locky Support Topic. Once at the topic, and if you are a registered member of the site, you can ask or answer questions and subscribe in order to get notifications when someone adds more information to the topic.
What is the Locky Ransomware?
Locky is a Windows ransomware infection that was released in the middle of February 2016. This ransomware infection will affect all versions of Windows, including Windows XP, Windows Vista, Windows 7, Windows 8, and Windows 10. When a victim is infected they will have their files encrypted and then a ransom of about .5 bitcoins will be demanded in order to receive the decryption key.
When Locky infects your computer it will scan all the drive letters and network shares for targeted file types and encrypt them using the AES encryption algorithm. Once these files are encrypted, they will no longer able to be opened by your normal programs. When Locky has finished encrypting the victim's files, it will change the desktop wallpaper to an image that acts like a ransom note. It will also display a HTML ransom note in your default browser.
These ransom notes include instructions on how to connect to the Locky Decryptor page where you can learn more about what happened to your files and how you can make a Locky ransom payment.
At today's current bitcoin rates, the ransom of .5 bitcoins is approximately $230 USD. The bitcoin address that you must submit payment to will be different for every victim.
How the Locky Ransomware encrypts your files
When Locky is first installed it will check to see if the computer is using the Russian language, and if it is, will not encrypt the computer. Otherwise, it will connect to a remote Command & Control server that is under the Locky developer's control and send it the ID associated with the victim's infection. This ID is generated by taking the first 16 characters of a MD5 hash of the GUID for the storage volume that Windows is installed on. Once it sends the ID, Locky will respond with an RSA key that will be used during the encryption process.
Locky will then create a Windows registry key that it will use to store configuration information. This registry key is located at HKCU\Software\[random].
Locky will now scan the computer's local, removable, mapped drives, and unmapped network shares for file types that it targets for encryption. The extensions targeted by Locky are:
.mid, .wma, .flv, .mkv, .mov, .avi, .asf, .mpeg, .vob, .mpg, .wmv, .fla, .swf, .wav, .qcow2, .vdi, .vmdk, .vmx, .gpg, .aes, .ARC, .PAQ, .tar.bz2, .tbk, .bak, .tar, .tgz, .rar, .zip, .djv, .djvu, .svg, .bmp, .png, .gif, .raw, .cgm, .jpeg, .jpg, .tif, .tiff, .NEF, .psd, .cmd, .bat, .class, .jar, .java, .asp, .brd, .sch, .dch, .dip, .vbs, .asm, .pas, .cpp, .php, .ldf, .mdf, .ibd, .MYI, .MYD, .frm, .odb, .dbf, .mdb, .sql, .SQLITEDB, .SQLITE3, .asc, .lay6, .lay, .ms11 (Security copy), .sldm, .sldx, .ppsm, .ppsx, .ppam, .docb, .mml, .sxm, .otg, .odg, .uop, .potx, .potm, .pptx, .pptm, .std, .sxd, .pot, .pps, .sti, .sxi, .otp, .odp, .wks, .xltx, .xltm, .xlsx, .xlsm, .xlsb, .slk, .xlw, .xlt, .xlm, .xlc, .dif, .stc, .sxc, .ots, .ods, .hwp, .dotm, .dotx, .docm, .docx, .DOT, .max, .xml, .txt, .CSV, .uot, .RTF, .pdf, .XLS, .PPT, .stw, .sxw, .ott, .odt, .DOC, .pem, .csr, .crt, .key, wallet.dat
When a file is encrypted it will generate a new AES encryption key and encrypt the file with it. This AES encryption key is then further encrypted by the RSA key that was retrieved from the Command & Control server. This RSA encrypted AES key will then be stored in the encrypted file.
When a file is encrypted it will be renamed to different formats depending on the version of Locky. Many of these extensions are named after gods from Norse and Egyption mythology. The current extension used by encrypted files is .OSIRIS.
Below is a list of extensions Locky has used for encrypted files:
Extension
File Format
Example Encrypted File
Begin Date
.locky
<16_char_victim_id><16_char_random_hex_number>.locky
A65091F1B14A911F0DD0E81ED3029F08.locky
Original Format
.zepto
[8_hexadecimal_chars]-[4_hexadecimal_chars]-[4_hexadecimal_chars]-[4_hexadecimal_chars]-[12_hexadecimal_chars].zepto.
024BCD33-41D1-ACD3-3EEA-84083E322DFA.zepto
6/27/16
.odin
[first_8_chars_of_id]--[next_4_chars_of_id]--[next_4_chars_of_id]--[8_hexadecimal_chars]--[12_hexadecimal_chars].odin
11111111--1111--1111--FC8BB0BA--5FE9D9C2B69A.odin
9/26/16
.shit
[first_8_chars_of_id]--[next_4_chars_of_id]--[next_4_chars_of_id]--[8_hexadecimal_chars]--[12_hexadecimal_chars].shit
11111111--1111--1111--FC8BB0BA--5FE9D9C2B69A.shit
10/24/16
.thor
[first_8_chars_of_id]--[next_4_chars_of_id]--[next_4_chars_of_id]--[8_hexadecimal_chars]--[12_hexadecimal_chars].thor
024BCD33-41D1-ACD3-3EEA-84083E322DFA.thor
10/25/16
.aesir
[first_8_hexadecimal_chars_of_id]-[next_4_hexadecimal_chars_of_id]-[next_4_hexadecimal_chars_of_id]-[4_hexadecimal_chars]-[12_hexadecimal_chars].aesir
016CCB88-61B1-ACB8-8FFA-86088F811BFA.aesir
11/21/16
.zzzzz
[first_8_hexadecimal_chars_of_id]-[next_4_hexadecimal_chars_of_id]-[next_4_hexadecimal_chars_of_id]-[4_hexadecimal_chars]-[12_hexadecimal_chars].zzzzz
016CCB88-61B1-ACB8-8FFA-86088F811BFA.zzzzz
11/24/16
.osiris
[first_8_chars_of_id]--[next_4_chars_of_id]--[next_4_chars_of_id]--[8_hexadecimal_chars]--[12_hexadecimal_chars].osiris
11111111--1111--1111--FC8BB0BA--5FE9D9C2B69A.osiris
12/05/16
.loptr
[first_8_chars_of_id]--[next_4_chars_of_id]--[next_4_chars_of_id]--[8_hexadecimal_chars]--[12_hexadecimal_chars].loptr
11111111--1111--1111--FC8BB0BA--5FE9D9C2B69A.loptr
5/10/17
.diablo6
[first_8_hexadecimal_chars_of_id]-[next_4_hexadecimal_chars_of_id]-[next_4_hexadecimal_chars_of_id]-[4_hexadecimal_chars]-[12_hexadecimal_chars].diablo6
E87091F1-D24A-922B-00F6B112-72BB7EA6EADF.diablo6
8/9/17
.lukitus
[first_8_hexadecimal_chars_of_id]-[next_4_hexadecimal_chars_of_id]-[next_4_hexadecimal_chars_of_id]-[4_hexadecimal_chars]-[12_hexadecimal_chars].lukitus
E87091F1-D24A-922B-00F6B112-72BB7EA6EADF.lukitus.
8/15/17
.ykcol
[first_8_hexadecimal_chars_of_id]-[next_4_hexadecimal_chars_of_id]-[next_4_hexadecimal_chars_of_id]-[4_hexadecimal_chars]-[12_hexadecimal_chars].ykcol
E87091F1-D24A-922B-00F6B112-72BB7EA6EADF.asasin
9/18/17
.asasin
[first_8_hexadecimal_chars_of_id]-[next_4_hexadecimal_chars_of_id]-[next_4_hexadecimal_chars_of_id]-[4_hexadecimal_chars]-[12_hexadecimal_chars].asasin
E87091F1-D24A-922B-00F6B112-72BB7EA6EADF.asasin
10/10/17
It important to stress that Locky will scan all drive letters on your computer including removable drives, network shares, and even DropBox mappings. In summary, if there is a drive letter on your computer it will be scanned for data files to encrypt by the ransomware
When the infection has finished scanning your computer it will attempt to delete all of the Shadow Volume Copies that are on the affected computer. It does this so that you cannot use the shadow volume copies to restore your encrypted files. In my tests, this process sometimes fails so you may be able to use the shadow volume copies to recover your files. The command that is run to clear the Shadow Volumes is:
vssadmin.exe Delete Shadows /All /Quiet
Now that your computer's data has been encrypted it will display the %UserProfile%\Desktop\_HELP_instructions.html ransom note, which is displayed below.
Locky Ransom Note
An example
text of the ransom note is:
﻿*+_+~~-+~=~*$$-!!! IMPORTANT INFORMATION !!!!
All of your files are encrypted with RSA-2048 and AES-128 ciphers.
More information about the RSA and AES can be found here:
http://en.wikipedia.org/wiki/RSA_(cryptosystem)
http://en.wikipedia.org/wiki/Advanced_Encryption_Standard
Decrypting of your files is only possible with the private key and decrypt program, which is on our secret server.
To receive your private key follow one of the links:
1. http://25z5g623wpqpdwis.tor2web.org/F61242A1A24B711E
2. http://25z5g623wpqpdwis.onion.to/F61242A1A24B711E
3. http://25z5g623wpqpdwis.onion.cab/F61242A1A24B711E
If all of this addresses are not available, follow these steps:
1. Download and install Tor Browser: https://www.torproject.org/download/download-easy.html
2. After a successful installation, run the browser and wait for initialization.
3. Type in the address bar: 25z5g623wpqpdwis.onion/F61242A1A24B711E
4. Follow the instructions on the site.
!!! Your personal identification ID: F61242A1A24B711E !!!
+$.+~-=*-.*.~.
=|++~--~=$_-|_
_=$.._
Locky will also change the Windows wallpaper to use the image located at %UserProfile%\Desktop\_HELP_instructions.bmp as shown below.
Locky Wallpaper
Both of these ransom notes will contain your unique ID and URLs to a TOR site where you can learn how much your ransom is and how to make the ransom payment. The payment site for Locky is called the Locky Decryptor Page. For more details about the
the payment site, please skip to this section.
What should you do when you discover your computer is infected with Locky
If you discover that your computer is infected with Locky you should immediately shutdown your computer and if possible create a copy, or image, of your hard drive. This allows you to save the complete state of your hard drive in the event that a free decryption method is developed in the future. For more information on how to do this, feel free to ask in the forums.
If you do not plan on paying the ransom and can restore from a backup, then scan your computer with an anti-virus or anti-malware program and let it remove everything. Unfortunately, most people do not realize Locky is on their computer until it displays the ransom note and your files have already been encrypted. The scans, though, will at least detect and remove any other malware that may have been installed along with the ransomware program.
As always we never recommend you pay the ransom, but if you do plan on doing so, it is important that you do not delete the ransom notes as you will need your ID to make payment.
How do you become infected with Locky?
A user is typically infected by Locky through emails that pretend to be invoices or via exploit kits on hacked sites. These invoices will have a subject similar to ATTN: Invoice J-12155976 or FW: Invoice and have an attached malicious word document or zip file containing a javascript installer. These attachments will have file names like Invoice J-12155976.doc or 138AD_scan_invoice_45E288.zip.
Example Distribution Emails.
Source: Fireye
When you double-click on the word document and enable macros or execute the javascript file, it will download the Locky ransomware executable and begin the encryption process.
Malicious Word Document
Locky can also infect your computer when you visit a hacked site that has an exploit kit on it. These exploit kits will scan your computer for vulnerable programs and attempt to exploit them to install and start the ransomware without your knowledge.
Therefore, it is imperative that everyone keeps Windows and their installed programs up-to-date. You can use these tutorials for more information on keeping your Windows installation and installed programs updated:
How to update WindowsHow to detect vulnerable and out-dated programs using Secunia Personal Software Inspector (PSI)
What you need to know about and Network Shares
Locky has the ability to encrypt files on network shares even if they are unmapped. Therefore, it is important that all system administrators tighten the permissions on their network shares and only give access as necessary.
It is still strongly suggested that you secure all open shares by only allowing writable access to the necessary user groups or authenticated users. This is an important security principle that should be used at all times regardless of infections like these.
How to find the infected user that encrypted a Network Share
For many system administrators, finding the infected computer that encrypted a network share can be a frustrating experience. When trying to figure this out, I always recommend that you check the properties of an encrypted file and check who the owner of the file is. You can use this owner to then pinpoint the infected machine.
The Locky Decryptor Page Payment Site
The developers of Locky created a TOR payment site called the Locky Decryptor Page. This site can be used by victims to pay the ransom and download a decryptor. When you visit this site you will receive information about your encrypted files and learn how to pay the ransom. Links to this site can be found in the ransom notes created on your Windows desktop and other locations on your computer. Once you visit the site you can pay the ransom, which is currently around $230 USD, by sending Bitcoins to the specified address.
Click on the image above to see the decryption sites.
Once a payment is made, the web site will wait for a certain amount of bitcoin confirmations before your private key will be made available to you. Once there have been enough confirmations, the decryptor will be made available to you for download. Please note that each victim has their own unique decryptor that will not work with any other infected computer. Therefore, the decryptor for one victim will NOT work on another victim's computer.
Will paying the ransom actually decrypt your files?
First and foremost, only pay the ransom if you have absolutely no choice. By paying the ransom you just encourage the malware developers to continue making ransomware infections like Locky.
With that said, if you have no choice, then
the ransomware developers will provide the decryption program if you pay the ransom. They know that if they do not deliver on their promises after making a payment, word will get out and no one else will pay.
Once you pay the ransom and it is verified, a download link will appear on your Locky Decryptor Page that will allow you to download a decryptor. Please note that the decryption process can take quite a bit of time.
Is it possible to decrypt files encrypted by Locky for Free?
Unfortunately, it is not currently possible decrypt Locky encrypted files for free. It may, though, be possible in the future if the decryption keys are recovered from the Locky Command & Control servers. Therefore, if you do not plan on paying the ransom, it is advised that you make an image of the encrypted drives so that you can possibly decrypt them in the future.
How to restore files encrypted by Locky
Your only way to recover Locky encrypted files is to try and restore them from a backup, from file recovery software, or if you are lucky, the Shadow Volume Copies. I have outlined different methods below that you can use to attempt to recover your files.
Method 1: Backups
The first and best method is to restore your data from a recent backup. If you have been performing backups, then you should use your backups to restore your data.
Method 2: Shadow Volume Copies
Surprisingly, on a recent test Locky did not properly wipe the Shadow Volume Copies. So I suggest that everyone try recovering their files using Shadow Volumes in the event that they were not deleted correctly. For more information on how to restore your files via Shadow Volume Copies, please see the link below:
How to restore files encrypted by Locky using Shadow Volume Copies
Method 3: File Recovery Software
When Locky encrypts a file it first makes a copy of it, encrypts the copy, and then deletes the original. Due to this you may be able to use file recovery software such as R-Studio or Photorec to possibly recover some of your original files. It is important to note that the more you use your computer after the files are encrypted the more difficult it will be for file recovery programs to recover the deleted
un-encrypted files.
Method 4: Restore DropBox Folders
If you had your dropbox account mapped as a drive letter then it is possible that its contents were encrypted by Locky. If this is the case you can use the link below to learn how to restore your files.
How to restore files that have been encrypted on DropBox folders
How to restore files encrypted by Locky using Shadow Volume Copies
If you had System Restore enabled on the computer, Windows creates shadow copy snapshots that contain copies of your files from that point of time when the system restore snapshot was created. These snapshots may allow us to restore a previous version of our files from before they had been encrypted. This method is not fool proof, though, as even though these files may not be encrypted they also may not be the latest version of the file. Please note that Shadow Volume Copies are only available with Windows XP Service Pack 2, Windows Vista, Windows 7, & Windows 8.
Note: Locky will attempt to delete all shadow copies when you first start any executable on your computer after becoming infected. Thankfully, the infection is not always able to remove the shadow copies, so there is a small chance you may be able to restore your files using this method.
In this section we provide two methods that you can use to restore files and folders from the Shadow Volume Copy. The first method is to use native Windows features and the second method is to use a program called ShadowExplorer. It does not hurt to try both and see which methods work better for you.
Using native Windows Previous Versions:
To restore individual files you can right-click on the file, go into Properties, and select the Previous Versions tab. This tab will list all copies of the file that have been stored in a Shadow Volume Copy and the date they were backed up as shown in the image below.
To restore a particular version of the file, simply click on the Copy button and then select the directory you wish to restore the file to. If you wish to restore the selected file and replace the existing one, click on the Restore button. If you wish to view the contents of the actual file, you can click on the Open button to see the contents of the file before you restore it.
This same method can be used to restore an entire folder. Simply right-click on the folder and select Properties and then the Previous Versions tabs. You will then be presented with a similar screen as above where you can either Copy the selected backup of the folder to a new location or Restore it over the existing folder.
Using ShadowExplorer:
You can also use a program called ShadowExplorer to restore entire folders at once. When downloading the program, you can either use the full install download or the portable version as both perform the same functionality.
When you start the program you will be shown a screen listing all the drives and the dates that a shadow copy was created. Select the drive (blue arrow) and date (red arrow) that you wish to restore from. This is shown in the image below.
To restore a whole folder, right-click on a folder name and select Export. You will then be prompted as to where you would like to restore the contents of the folder to.
How to restore files that have been encrypted on DropBox folders
If you have DropBox mapped to a drive letter on an infected computer or synchronized to a folder, Locky will attempt to encrypt the files on it. DropBox offers free versioning on all of its accounts that will allow you to restore encrypted files through their website. Unfortunately, the restoral process offered by DropBox only allows you to restore one file at a time rather than a whole folder. If you need instructions on restoring an entire folder in DropBox, please click here.
To restore a file, simply login to the DropBox web site and navigate to the folder that contains the encrypted files you wish to restore. Once you are in the folder, right-click on the encrypted file and select Previous Versions as shown in the image below.
When you click on Previous versions you will be presented with a screen that shows all versions of the encrypted file.
Select the version of the file you wish to restore and click on the Restore button to restore that file.
Unfortunately the process outlined above can be very time consuming if there are many folder to restore. In order to restore an entire folder of encrypted files, you can use the dropbox-restore python script located here. Please note that this script requires Python to be installed on the encrypted computer to execute the script. Instructions on how to use this script can be found in the README.md file for this project.
How to prevent your computer from becoming infected by Locky
There are a few methods and utilities that we recommend in order to protect your computer from
ransomware infections. Three of the methods are the Emsisoft Anti-Malware, HitmanPro: Alert, and the Malwarebytes Anti-Ransomware and HitmanPro: Alert programs. The fourth option is to utilize Software Restriction Policies
that prevent programs from being allowed to execute from certain locations. In full disclosure, BleepingComputer.com makes a commission off of the sales of Emsisoft Anti-Malware, HitmanPro: Alert, and CryptoPrevent, but does not from Malwarebytes Anti-Ransomware.
Emsisoft Anti-Malware:
Emsisoft Anti-Malware, or EAM, has a feature called behavior blocker that has a proven track record of blocking ransomware before it can start encrypting data on your computer. Unlike traditional antivirus definitions, EAM's behavior blocker examines the behavior of a process and if this behavior contains certain characteristics commonly found in malware it will prevent it from running. Using the detection method, behavior blocker detects when a process is scanning a computer for files and then attempting to encrypt them. If it discovers this behavior, it will automatically terminate the process.
According to an article at Emsisoft's site, EAM's behavior blocker was able to block 20 crypto-ransomware families without the use of signatures.
You can find more information about Emsisoft Anti-Malware and behavior blocker here: https://www.emsisoft.com/en/software/antimalware/
HitmanPro: Alert:
HitmanPro: Alert is a great program as well but is designed as a full featured anti-exploit program and is not targeted exclusively at ransomware infections. Alert provides protection from computer vulnerabilities and malware that attempts to steal your data. Unfortunately, because this program has a much broader focus it sometimes needs to be updated as new ransomware is released. As long as you stay on top of the updates, HitmanPro: Alert offers excellent protection.
You can find more information about HitmanPro: Alert here: http://www.surfright.nl/en/alert
Malwarebytes Anti-Ransomware
Malwarebytes Anti-Ransomware is another program that does not rely on signatures or heuristics, but rather by detecting behavior that is consistent with what is seen in ransomware infections. At this point, Malwarebytes Anti-Ransomware is currently in beta, so be careful about using this on a production environment until the kinks are worked out.
You can download and get more information information about Malwarebytes Anti-Ransomware here: https://www.bleepingcomputer.com/download/malwarebytes-anti-ransomware/
Configure Application Whitelisting:
A very secure method of preventing a ransomware, or almost any other malware, infection is to use a method called Application Whitelisting. Application whitelisting is when you lock down Windows so that all executables are denied except for those that you specifically allow to run. Since you are only allowing programs you trust to run, if you are infected the malware executable would not be able to run and thus could not infect you. For those who are interested in learning more about application whitelisting, you can view this tutorial: How to create an Application Whitelist Policy in Windows.
Use Software Restriction Policies to block executables in certain file locations:
You can use the Windows Group or Local Policy Editor to create Software Restriction Policies that block executables from running when they are located in specific file locations. For more information on how to configure Software Restriction Policies, please see these articles from MS:
http://support.microsoft.com/kb/310791http://technet.microsoft.com/en-us/library/cc786941(v=ws.10).aspx
The file paths that have been used by this infection and its droppers are:
C:\Users\<User>\AppData\Local\<random>.exe (Vista/7/8)
C:\Users\<User>\AppData\Local\<random>.exe (Vista/7/8)
C:\Documents and Settings\<User>\Application Data\<random>.exe (XP)
C:\Documents and Settings\<User>\Local Application Data\<random>.exe
(XP)
%Temp%
C:\Windows
In order to block Locky, and other ransomware, you want to create Path Rules so that they are not allowed to execute. To create these Software Restriction Policies, you can either use the CryptoPrevent tool or add the policies manually using the Local Security Policy Editor or the Group Policy Editor. Both methods are described below.
Note: If you are using Windows Home or Windows Home Premium, the Local Security Policy Editor will not be available to you. Instead we suggest you use the CryptoPrevent tool, which will automatically set these policies for you.
How to use the CryptoPrevent Tool:
FoolishIT LLC was kind enough to create a free utility called CryptoPrevent that automatically adds the suggested Software Restriction Policy Path Rules listed above to your computer. This makes it very easy for anyone using Windows XP SP 2 and above to quickly add the Software Restriction Policies to your computer in order to prevent Locky, and other ransomware, from being executed in the first place. This tool is also able to set these policies in all versions of Windows, including the Home versions.
A new feature of CryptoPrevent is the option to whitelist any existing programs in %AppData% or %LocalAppData%. This is a useful feature as it will make sure the restrictions that are put in place do not affect legitimate applications that are already installed on your computer. To use this feature make sure you check the option labeled Whitelist EXEs already located in %AppData% / %LocalAppData% before you press the Block button.
Tip: You can use CryptoPrevent for free, but if you wish to purchase the premium version you can use the coupon code bleeping30off to get 30% off. The premium version includes automatic and silent updating of application and definitions on a regular schedule, email alerts when an application blocked, and custom
allow and block policies to fine-tune your protection.
You can download CryptoPrevent from the following page:
http://www.foolishit.com/download/cryptoprevent/
For more information on how to use the tool, please see this page:
http://www.foolishit.com/vb6-projects/cryptoprevent/
Once you run the program, simply click on the Apply Protection
button to add the default Software Restriction Policies to your computer. If you wish to customize the settings, then please review the checkboxes and change them as necessary. If CryptoPrevent causes issues running legitimate applications, then please see this section on how to enable specific applications. You can also remove the Software Restriction Policies that were added by clicking on the Undo button.
How to manually create Software Restriction Policies to block Locky:
In order to manually create the Software Restriction Policies you need to be using Windows Professional or Windows Server. If you want to set these policies for a particular computer you can use the Local Security Policy Editor. If you wish to set these policies for the entire domain, then you need to use the Group Policy Editor. Unfortunately, if you are a Windows Home user, the Local Policy Editor is not available and you should use the CryptoPrevent tool instead to set these policies. To open the Local Security Policy editor, click on the Start button and type Local Security Policy and select the search result that appears. You can open the Group Policy Editor by typing Group Policy instead. In this guide we will use the Local Security Policy Editor in our examples.
Once you open the Local Security Policy Editor, you will see a screen similar to the one below.
Once the above screen is open, expand Security Settings and then click on the Software Restriction Policies section. If you do not see the items in the right pane as shown above, you will need to add a new policy. To do this click on the Action button and select New Software Restriction Policies. This will then enable the policy and the right pane will appear as in the image above. You should then click on the Additional Rules category and then right-click in the right pane and select New Path Rule.... You should then add a Path Rule for each of the items listed below.
If the Software Restriction Policies cause issues when trying to run legitimate applications, you should see this section on how to enable specific applications.
Below are a few Path Rules that are suggested you use to not only block the infections from running, but also to block attachments from being executed when opened in an e-mail client.
Block executables in %AppData%
Path: %AppData%\*.exe Security Level: DisallowedDescription: Don't allow executables to run from %AppData%.
Block executables in %LocalAppData%
Path if using Windows XP: %UserProfile%\Local Settings\*.exePath if using Windows Vista/7/8: %LocalAppData%\*.exeSecurity Level: DisallowedDescription: Don't allow executables to run from %AppData%.
Block executables in %AppData%\[subfolder]\
Path: %AppData%\*\*.exe Security Level: DisallowedDescription: Don't allow executables to run from immediate subfolders of %AppData%.
Block executables in %LocalAppData%
Path if using Windows XP: %UserProfile%\Local Settings\*\*.exePath if using Windows Vista/7/8: %LocalAppData%\*\*.exeSecurity Level: DisallowedDescription: Don't allow executables to run from immediate subfolders of %AppData%.
Block executables running from archive attachments opened with WinRAR:
Path if using Windows XP: %UserProfile%\Local Settings\Temp\Rar*\*.exePath if using Windows Vista/7/8: %LocalAppData%\Temp\Rar*\*.exe
Security Level: DisallowedDescription: Block executables run from archive attachments opened with WinRAR.
Block executables running from archive attachments opened with 7zip:
Path if using Windows XP: %UserProfile%\Local Settings\Temp\7z*\*.exePath if using Windows Vista/7/8: %LocalAppData%\Temp\7z*\*.exe
Security Level: DisallowedDescription: Block executables run from archive attachments opened with 7zip.
Block executables running from archive attachments opened with WinZip:
Path if using Windows XP: %UserProfile%\Local Settings\Temp\wz*\*.exePath if using Windows Vista/7/8: %LocalAppData%\Temp\wz*\*.exe
Security Level: DisallowedDescription: Block executables run from archive attachments opened with WinZip.
Block executables running from archive attachments opened using Windows built-in Zip support:
Path if using Windows XP: %UserProfile%\Local Settings\Temp\*.zip\*.exePath if using Windows Vista/7/8: %LocalAppData%\Temp\*.zip\*.exe
Security Level: DisallowedDescription: Block executables run from archive attachments opened using Windows built-in Zip support.
You can see an event log entry and alert showing an executable being blocked:
If you need help configuring this, feel free to ask in the Locky Support Topic
How to allow specific applications to run when using Software Restriction Policies
If you use Software Restriction Policies, or CryptoPrevent, to block Locky you may find that some legitimate applications no longer run. This is because some companies mistakenly install their applications under a user's profile rather than in the Program Files folder where they belong. Due to this, the Software Restriction Policies will prevent those applications from running.
Thankfully, when Microsoft designed Software Restriction Policies they made it so a Path Rule that specifies a program is allowed to run overrides any path rules that may block it. Therefore, if a Software Restriction Policy
is blocking a legitimate program, you will need to use the manual steps given above to add a Path Rule that allows the program to run. To do this you will need to create a Path Rule for a particular program's executable and set the Security Level to Unrestricted instead of Disallowed as shown in the image below.
Once you add these Unrestricted Path Rules, the specified applications will be allowed to run again.
View Associated Locky Files
%UserpProfile%\Desktop\_HELP_instructions.bmp
%UserpProfile%\Desktop\_HELP_instructions.html
%UserpProfile%\Desktop\_Locky_recover_instructions.bmp
%UserpProfile%\Desktop\_Locky_recover_instructions.txt
%Temp%\[random].exe
File Location Notes:%Temp% refers to the Windows Temp folder.
By default, this is C:\Windows\Temp for Windows 95/98/ME, C:\DOCUMENTS AND SETTINGS\<Current User>\LOCAL SETTINGS\Temp for Windows 2000/XP, and C:\Users\<Current User>\AppData\Local\Temp in Windows Vista, Windows 7, and Windows 8.
View Associated Locky Registry Information
HKCU\Software\[random]
HKCU\Software\Locky
HKCU\Software\Locky\id
HKCU\Software\Locky\pubkey
HKCU\Software\Locky\paytext
HKCU\Software\Locky\completed
This is a self-help guide. Use at your own risk.
BleepingComputer.com can not be held responsible for problems that may occur by using this information. If you would like help with any of these fixes, you can ask for malware removal assistance in our Virus,Trojan,Spyware, and Malware Removal Logs forum.
If you have any questions about this self-help guide then please post those questions in our Am I infected? What do I do? and someone will help you.
search guides
Latest Guides
Theonlinesearch.com Smartwebfinder.com PBlock+ adware browser extension Toksearches.xyz Smashapps.net Search Redirect Smashappsearch.com Search Redirect BipApp Chrome Extension Please Allow to watch the video Notification Page Annual visitor survey Scam Chrome search contest 2020 Scam
Removal Tool Guides
ComboFix
Emsisoft Anti-Malware
Malwarebytes Anti-Malware
Malwarebytes' Anti-Rootkit
SUPERAntiSpyware
Threat Descriptions
Adware
Browser Extensions and Add-ons
Browser Hijacker
Potentially Unwanted Programs (PUP)
Ransomware
Rogue Programs & Scareware
Rootkits
Spyware
Tech Support Scams
Trojan Horses
Unwanted Browser Advertisements
Worms
Follow us:
Main Sections
News
VPN Buyer Guides
SysAdmin Software Guides
Downloads
Virus Removal Guides
Tutorials
Startup Database
Uninstall Database
Glossary
Community
Forums
Forum Rules
Chat
Useful Resources
Welcome Guide
Sitemap
Company
About BleepingComputer
Contact Us
Send us a Tip!
Advertising
Write for BleepingComputer
Social & Feeds
Changelog
Terms of Use
-
Privacy Policy - Ethics Statement - Affiliate Disclosure
Copyright @ 2003 - 2025
Bleeping Computer® LLC
-
All Rights Reserved
Login
Username
Password
Remember Me
Sign in anonymously
Sign in with Twitter
Not a member yet? Register Now