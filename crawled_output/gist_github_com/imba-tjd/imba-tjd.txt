imba-tjd’s gists · GitHub
Skip to content
Search Gists
Search Gists
All gists
Back to GitHub
Sign in
Sign up
Sign in
Sign up
You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.
Dismiss alert
Instantly share code, notes, and snippets.
谭九鼎
imba-tjd
232
followers
·
13
following
China
https://www.zhihu.com/people/tan-jiu-ding
View GitHub Profile
All gists
26
Starred
12
Sort
Recently created
Least recently created
Recently updated
Least recently updated
Sort
Recently created
Least recently created
Recently updated
Least recently updated
1 file
0 forks
0 comments
0 stars
imba-tjd
/ battery.c
Last active
February 20, 2025 11:24
Show warning when battery die
// gcc battery.c -o battery.exe -Os -mwindows -Wl,--as-needed -s -nostdlib -luser32 -lkernel32 -march=native
#define WIN32_LEAN_AND_MEAN
#include <windows.h>
static SYSTEM_POWER_STATUS status;
int _main() {
SetProcessWorkingSetSize(GetCurrentProcess(), (SIZE_T)-1, (SIZE_T)-1);
while (1) {
1 file
0 forks
0 comments
0 stars
imba-tjd
/ udphp.py
Created
October 19, 2024 11:56
udp hole punching
# 当两台电脑都有公网IP，却无法访问时，可能是被防火墙拦截了。inbound filter只允许内部往外部建立连接。
# 想到普通家宽，建立连接后，双方是可以互发消息的，证明网络是通的。而UDP是无连接的，怎么做到收回复呢？
# 其实防火墙的原理是检测发出去的五元组，遇到对应的回复就放行传入。
# 从实践上来说，只要双方互发消息，就可以了。这就是“打洞”
import socket, time, sys, threading
s = socket.socket(socket.AF_INET6, socket.SOCK_DGRAM)
s.bind(('::', int(sys.argv[1])))
target = (sys.argv[2], int(sys.argv[3]))
1 file
0 forks
1 comment
0 stars
imba-tjd
/ server.c
Last active
November 3, 2024 14:00
Windows httpapi server example.
// https://learn.microsoft.com/zh-cn/windows/win32/Http
// gcc server.c -Os -Wall -lhttpapi -o server
#define WIN32_LEAN_AND_MEAN
#include <stdio.h>
#include <stdlib.h>
#include <http.h>
#include <windows.h>
#include <signal.h>
1 file
0 forks
0 comments
0 stars
imba-tjd
/ AutoRemove-NetFirewallRule.ps1
Created
March 3, 2023 04:22
Auto remove invalid Windows Firewall rules
# needs Admin privilege
# TODO: Add -confirm
$rules = Get-NetFirewallRule
foreach ($rule in $rules) {
if ($rule.Name.contains("Query User")) {
$filepath = $rule.Name.Substring($rule.Name.Indexof('}')+1)
if (-not (Test-Path $filepath)) {
echo "Removing $filepath"
2 files
0 forks
0 comments
0 stars
imba-tjd
/ Readme.md
Last active
February 14, 2023 01:50
Call UWP / WinRT API from Win32 without installing Windows SDK
I googled it for a long time and I'm really suprised no one mentioned this.
.NET5+ https://github.com/microsoft/CsWinRT
FX4.6+ https://www.nuget.org/packages/Microsoft.Windows.SDK.Contracts
1 file
0 forks
0 comments
0 stars
imba-tjd
/ xargsu2a.cs
Last active
July 8, 2023 13:54
A program helps pwsh to read from utf8 output.
// This program helps pwsh to read from external program output from utf8 encoding.
// Compile: bflat build xargsu2a.cs -Ot --no-debug-info --no-globalization --no-reflection --no-stacktrace-data
// License: MIT
using System;
using System.Diagnostics;
using System.Text;
if (args.Length == 0)
{
1 file
0 forks
0 comments
0 stars
imba-tjd
/ urld.c
Last active
July 8, 2023 13:52
// https://github.com/abejfehr/URLDecode
// Compile: gcc -Ofast -mtune=native -D__USE_MINGW_ANSI_STDIO -o urld.exe
// When decoding UTF8-encoded data, work with [xargsu2a](https://gist.github.com/imba-tjd/0a5a41df029babc6c814efe5d9296593)
#include <ctype.h>
#include <stdlib.h>
#include <string.h>
#include <stdio.h>
char *urlDecode(const char *str) {
int d = 0;
1 file
0 forks
0 comments
0 stars
imba-tjd
/ realpath.go
Last active
February 2, 2023 03:21
realpath.exe for windows
// Git for Windows or git-bash contains a realpath.exe which is required by git code.editor
// However I'm using Git distribution from VS, which doesn't have it.
// Copying from Git for Windows isn't a good choice because it needs msys-2.0.dll
// This program offers similar function, which is enough for me.
// It won't resolve '~'. It works when path contains whitespaces.
package main
import (
"fmt"
1 file
0 forks
0 comments
0 stars
imba-tjd
/ KPBackuper.cs
Last active
January 26, 2023 13:53
// KP Backuper：帮助解决卡琳典狱长在非最低难度下强制覆盖自动保存的特性。
// 放到与nw.exe同一目录下。运行后每隔一分钟会检测存档有没有发生变化，如果变了，就备份到www/save_bak目录下。
// 并发安全性：读取时会加读锁，因此不会读到一半游戏自动保存导致读取内容错误，副作用是此次游戏的自动保存会不生效（静默失败）；但本游戏保存很频繁，因此无影响。对于游戏保存到一半时本程序触发读，本程序会过一秒钟重试。
// 编译：C:\tools\bflat-7.0.1-windows-x64\bflat.exe build KPBackuper.cs -Os --no-globalization --no-reflection --no-stacktrace-data && upx --lzma KPBackuper.exe
using System;
using System.IO;
using System.Threading;
using System.Runtime.InteropServices;
[DllImport("user32")]
1 file
0 forks
0 comments
0 stars
imba-tjd
/ ngenize.cs
Last active
February 22, 2023 12:31
A wrapper for ngen.exe
// LICENSE: MIT
using System;
using System.IO;
using System.Diagnostics;
using System.Reflection;
class Ngenize
{
const string NgenX86Path = @"C:\Windows\Microsoft.NET\Framework\v4.0.30319\ngen.exe";
const string NgenX64Path = @"C:\Windows\Microsoft.NET\Framework64\v4.0.30319\ngen.exe";
NewerOlder
Footer
© 2025 GitHub, Inc.
Footer navigation
Terms
Privacy
Security
Status
Docs
Contact
Manage cookies
Do not share my personal information
You can’t perform that action at this time.